library(tidyverse)
filepath_main <- "C:/Users/samvida/Documents/Lindgren Group/Adiposity_Primary_Care/2211_models/"
# Read data ----
STRATA <- c("BMI_F", "BMI_M", "BMI_sex_comb",
"Weight_F", "Weight_M", "Weight_sex_comb")
all_lead_snps <- lapply(STRATA, function (s) {
res <- read.table(paste0(filepath_main,
"lead_snps/", s, "_b0_final.lead_snps.txt"),
sep = "\t", header = T, stringsAsFactors = F)
return (res)
})
names(all_lead_snps) <- STRATA
novel_refined_snps <- lapply(STRATA, function (s) {
res <- read.table(paste0(filepath_main, s, "/to_annotate_results_refined_novel_snps.txt"),
sep = "\t", header = T, stringsAsFactors = F)
return (res)
})
names(novel_refined_snps) <- STRATA
# Get percent of lead SNPs that are novel or refined ----
unique_lead_snps <- lapply(STRATA, function (s) {
res <- all_lead_snps[[s]] %>%
mutate(chrpos = paste0(chromosome, ":", position)) %>%
select(all_of(c("rsid", "chrpos")))
return (res)
})
unique_lead_snps <- bind_rows(unique_lead_snps) %>%
distinct()
unique_novel_refined_snps <- lapply(STRATA, function (s) {
res <- novel_refined_snps[[s]] %>%
rename(rsid = SNP_og, chr = CHR_og, pos = POS_og) %>%
mutate(chrpos = paste0(chr, ":", pos)) %>%
select(all_of(c("rsid", "chrpos", "status")))
return (res)
})
unique_novel_refined_snps <- bind_rows(novel_refined_snps) %>%
distinct()
prop_var_novel_refined <- lapply(STRATA, function (s) {
df <- all_lead_snps[[s]]
df <- df %>%
mutate(varexp = (beta^2)*2*maf*(1 - maf),
status = ifelse(rsid %in% novel_refined_snps[[s]]$SNP_og,
"novel_refined", "published"))
vexp <- df %>% group_by(status) %>%
summarise(varexp = sum(varexp),
n = n()) %>%
mutate(strata = s)
return (vexp)
})
prop_var_novel_refined <- bind_rows(prop_var_novel_refined)
View(prop_var_novel_refined)
prop_var_novel_refined
ggplot(prop_var_novel_refined[grep("BMI", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
coord_flip()
theme_set(theme_bw())
col_palette <- c("#009593", "#C7B241", "#D35C79")
names(col_palette) <- c("published", "novel_refined", "novel")
ggplot(prop_var_novel_refined[grep("BMI", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = F) +
coord_flip()
prop_var_novel_refined <- bind_rows(prop_var_novel_refined) %>%
mutate(strata = factor(strata, levels = c("Weight_sex_comb", "Weight_M", "Weight_F",
"BMI_sex_comb", "BMI_M", "BMI_F")))
ggplot(prop_var_novel_refined[grep("BMI", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
coord_flip()
ggplot(prop_var_novel_refined[grep("BMI", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
bmi_plot <- ggplot(prop_var_novel_refined[grep("BMI", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "bmi_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(bmi_plot)
dev.off()
weight_plot <- ggplot(prop_var_novel_refined[grep("Weight", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "weight_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(weight_plot)
dev.off()
col_palette <- c("#009593", "#C7B241", "#D35C79")
names(col_palette) <- c("published", "refined", "novel_refined")
prop_var_novel_refined <- lapply(STRATA, function (s) {
df <- all_lead_snps[[s]]
df <- df %>%
mutate(varexp = (beta^2)*2*maf*(1 - maf),
status = ifelse(rsid %in% novel_refined_snps[[s]]$SNP_og,
"novel_refined", "published"))
vexp <- df %>% group_by(status) %>%
summarise(varexp = sum(varexp),
n = n()) %>%
mutate(strata = s)
return (vexp)
})
prop_var_novel_refined <- bind_rows(prop_var_novel_refined) %>%
mutate(strata = factor(strata, levels = c("Weight_sex_comb", "Weight_M", "Weight_F",
"BMI_sex_comb", "BMI_M", "BMI_F")))
bmi_plot <- ggplot(prop_var_novel_refined[grep("BMI", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "bmi_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(bmi_plot)
dev.off()
weight_plot <- ggplot(prop_var_novel_refined[grep("Weight", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "weight_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(weight_plot)
dev.off()
bmi_plot <- ggplot(prop_var_novel_refined[grep("BMI", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
scale_y_continuous(limits = c(0, 0.06)) +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "bmi_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(bmi_plot)
dev.off()
weight_plot <- ggplot(prop_var_novel_refined[grep("Weight", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
scale_y_continuous(limits = c(0, 0.06)) +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "weight_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(weight_plot)
dev.off()
bmi_plot <- ggplot(prop_var_novel_refined[grep("BMI", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
scale_y_continuous(limits = c(0, 0.04)) +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "bmi_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(bmi_plot)
dev.off()
weight_plot <- ggplot(prop_var_novel_refined[grep("Weight", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
scale_y_continuous(limits = c(0, 0.07)) +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "weight_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(weight_plot)
dev.off()
weight_plot <- ggplot(prop_var_novel_refined[grep("Weight", prop_var_novel_refined$strata), ],
aes(x = strata, y = varexp)) +
geom_col(aes(fill = status), width = 0.7) +
scale_fill_manual(values = col_palette, guide = "none") +
scale_y_continuous(limits = c(0, 0.075)) +
coord_flip() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
tiff(filename = paste0(filepath_main, "weight_varexpl.tiff"),
height = 5, width = 5, units = "cm",
res = 300)
print(weight_plot)
dev.off()
