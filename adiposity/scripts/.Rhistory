PHENOTYPES <- c("weight", "waist", "BMI", "WHR", "vfat")
V2_CODES <- c("22A..", "22N0.", "22K..", "22N7.", "22Y3.")
V3_CODES <- c("22A..", "Xa041", "22K..", "X76CX", "XaZOn")
names(V2_CODES) <- PHENOTYPES
names(V3_CODES) <- PHENOTYPES
V2_CODES["BMI"]
library(lubridate)
library(eeptools)
library(dplyr)
gp_clinical <- read.table("C:/Users/samvida/Documents/Lindgren Group/Resources/UKBIOBANK/subset_gp_clinical_annotated.txt",
sep = "\t", header = T, quote = "", fill = F, comment.char = "~",
stringsAsFactors = F)
head(gp_clinical)
gp_clinical$event_dt <- as.Date(gp_clinical$event_dt, "%d/%m/%Y")
gp_clinical$dob <- as.Date(gp_clinical$dob, "%d/%m/%Y")
cleaned <- subset(gp_clinical, !is.na(gp_clinical$event_dt))
head(gp_clinical)
gp_clinical <- read.table("C:/Users/samvida/Documents/Lindgren Group/Resources/UKBIOBANK/subset_gp_clinical_annotated.txt",
sep = "\t", header = T, quote = "", fill = F, comment.char = "~",
stringsAsFactors = F)
head(gp_clinical$event_dt)
as.Date(gp_clinical$event_dt, "%Y-%m/%d")
as.Date(gp_clinical$event_dt, "%Y/%m/%d")
as.Date(gp_clinical$event_dt, "%Y-%m-%d")
as.Date(gp_clinical$dob, "%Y-%m-%d")
gp_clinical$event_dt <- as.Date(gp_clinical$event_dt, "%Y-%m-%d")
gp_clinical$dob <- as.Date(gp_clinical$dob, "%Y-%m-%d")
# Remove inconsistencies (NA in event date, event date before date-of-birth,
# and event date after 2020)
cleaned <- subset(gp_clinical, !is.na(gp_clinical$event_dt))
cleaned <- subset(cleaned, !is.na(gp_clinical$dob))
cleaned <- subset(cleaned, cleaned$event_dt > cleaned$dob)
cleaned <- subset(cleaned, cleaned$event_dt <= as.Date("2020-10-01"))
cleaned$age_years <- age_calc(cleaned$dob, cleaned$event_dt, units = "years")
write.table(cleaned, "C:/Users/samvida/Documents/Lindgren Group/Resources/UKBIOBANK/subset_gp_clinical_annotated.txt",
sep = "\t", quote = F, row.names = F)
View(gp_clinical)
View(cleaned)
annotated_variants <- readRDS("C:/Users/samvida/Documents/Lindgren Group/Obesity_WRH_Project/Clustering_Variant_Effects/data/annotated_variants.rds")
View(annotated_variants)
